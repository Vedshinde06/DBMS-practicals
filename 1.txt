
Consider following Relation 
Account (Acc_no, branch_name,balance) 
Branch(branch_name,branch_city,assets) 
Customer(cust_name,cust_street,cust_city) 
Depositor(cust_name,acc_no) 
Loan(loan_no,branch_name,amount) 
Borrower(cust_name,loan_no) 
Create above tables with appropriate constraints like primary key, 
foreign key, not null etc. 
	1. Find the names of all branches in loan relation. 
	2. Find all loan numbers for loans made at ‘Wadia College’ Branch 
	with loan amount > 12000. 
	3. Find all customers who have a loan from bank. Find their 
	names,loan_no and loan amount. 
	4. List all customers in alphabetical order who have loan from 
	‘Wadia College’ branch. 
	5. Display distinct cities of branch. 

CREATE TABLE Branch (
    branch_name VARCHAR(50) PRIMARY KEY,
    branch_city VARCHAR(50) NOT NULL,
    assets DECIMAL(15,2) CHECK (assets >= 0)
);

CREATE TABLE Account (
    acc_no INT PRIMARY KEY,
    branch_name VARCHAR(50) NOT NULL,
    balance DECIMAL(15,2) CHECK (balance >= 0),
    FOREIGN KEY (branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Customer (
    cust_name VARCHAR(50) PRIMARY KEY,
    cust_street VARCHAR(100),
    cust_city VARCHAR(50)
);

CREATE TABLE Depositor (
    cust_name VARCHAR(50) NOT NULL,
    acc_no INT NOT NULL,
    PRIMARY KEY (cust_name, acc_no),
    FOREIGN KEY (cust_name) REFERENCES Customer(cust_name),
    FOREIGN KEY (acc_no) REFERENCES Account(acc_no)
);

CREATE TABLE Loan (
    loan_no INT PRIMARY KEY,
    branch_name VARCHAR(50) NOT NULL,
    amount DECIMAL(15,2) CHECK (amount > 0),
    FOREIGN KEY (branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Borrower (
    cust_name VARCHAR(50) NOT NULL,
    loan_no INT NOT NULL,
    PRIMARY KEY (cust_name, loan_no),
    FOREIGN KEY (cust_name) REFERENCES Customer(cust_name),
    FOREIGN KEY (loan_no) REFERENCES Loan(loan_no)
);




INSERT INTO Branch (branch_name, branch_city, assets)
VALUES
('Wadia College', 'Pune', 9000000),
('MG Road', 'Mumbai', 12000000),
('JM Road', 'Pune', 8000000),
('Camp', 'Nashik', 6000000);

INSERT INTO Account (acc_no, branch_name, balance)
VALUES
(1001, 'Wadia College', 25000),
(1002, 'MG Road', 45000),
(1003, 'JM Road', 15000),
(1004, 'Wadia College', 55000),
(1005, 'Camp', 32000);

INSERT INTO Customer (cust_name, cust_street, cust_city)
VALUES
('Amit Deshmukh', 'FC Road', 'Pune'),
('Priya Patil', 'MG Road', 'Mumbai'),
('Rohit Shinde', 'Karve Nagar', 'Pune'),
('Sneha Joshi', 'College Road', 'Nashik'),
('Dnyanesh Bhosale', 'Tilak Road', 'Pune');

INSERT INTO Depositor (cust_name, acc_no)
VALUES
('Amit Deshmukh', 1001),
('Priya Patil', 1002),
('Rohit Shinde', 1003),
('Sneha Joshi', 1005),
('Dnyanesh Bhosale', 1004);

INSERT INTO Loan (loan_no, branch_name, amount)
VALUES
(2001, 'Wadia College', 15000),
(2002, 'MG Road', 10000),
(2003, 'JM Road', 18000),
(2004, 'Wadia College', 25000),
(2005, 'Camp', 8000);

INSERT INTO Borrower (cust_name, loan_no)
VALUES
('Amit Deshmukh', 2001),
('Priya Patil', 2002),
('Rohit Shinde', 2003),
('Dnyanesh Bhosale', 2004),
('Sneha Joshi', 2005);

1)

SELECT DISTINCT branch_name
FROM Loan;

2)

SELECT loan_no
FROM Loan
WHERE branch_name = 'Wadia College'
  AND amount > 12000;

3)

SELECT c.cust_name, l.loan_no, l.amount
FROM Customer c
JOIN Borrower b ON c.cust_name = b.cust_name
JOIN Loan l ON b.loan_no = l.loan_no;

4)

SELECT DISTINCT c.cust_name
FROM Customer c
JOIN Borrower b ON c.cust_name = b.cust_name
JOIN Loan l ON b.loan_no = l.loan_no
WHERE l.branch_name = 'Wadia College'
ORDER BY c.cust_name ASC;

5) 

SELECT DISTINCT branch_city
FROM Branch;


