 
Consider following Relation 
Account (Acc_no, branch_name,balance) 
Branch(branch_name,branch_city,assets) 
Customer(cust_name,cust_street,cust_city) 
Depositor(cust_name,acc_no) 
Loan(loan_no,branch_name,amount) 
Borrower(cust_name,loan_no) 
Execute the following query: 
1. Create a View1 to display List all customers in alphabetical 
order who have loan from Pune_Station branch. 
2. Create View2 on branch table by selecting any two columns and 
perform insert update delete operations. 
3. Create View3 on borrower and depositor table by selecting any 
one column from each table perform insert update delete 
operations. 
4. Create Union of left and right joint for all customers who have 
an account or loan or both at bank 
5. Create Simple and Unique index. 
6. Display index Information. 


CREATE TABLE Branch (
    branch_name VARCHAR(50) PRIMARY KEY,
    branch_city VARCHAR(50) NOT NULL,
    assets DECIMAL(15,2) CHECK (assets >= 0)
);

CREATE TABLE Account (
    acc_no INT PRIMARY KEY,
    branch_name VARCHAR(50) NOT NULL,
    balance DECIMAL(15,2) CHECK (balance >= 0),
    FOREIGN KEY (branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Customer (
    cust_name VARCHAR(50) PRIMARY KEY,
    cust_street VARCHAR(100),
    cust_city VARCHAR(50)
);

CREATE TABLE Depositor (
    cust_name VARCHAR(50) NOT NULL,
    acc_no INT NOT NULL,
    PRIMARY KEY (cust_name, acc_no),
    FOREIGN KEY (cust_name) REFERENCES Customer(cust_name),
    FOREIGN KEY (acc_no) REFERENCES Account(acc_no)
);

CREATE TABLE Loan (
    loan_no INT PRIMARY KEY,
    branch_name VARCHAR(50) NOT NULL,
    amount DECIMAL(15,2) CHECK (amount > 0),
    FOREIGN KEY (branch_name) REFERENCES Branch(branch_name)
);

CREATE TABLE Borrower (
    cust_name VARCHAR(50) NOT NULL,
    loan_no INT NOT NULL,
    PRIMARY KEY (cust_name, loan_no),
    FOREIGN KEY (cust_name) REFERENCES Customer(cust_name),
    FOREIGN KEY (loan_no) REFERENCES Loan(loan_no)
);


INSERT INTO Branch VALUES
('Pune_Station', 'Pune', 8000000),
('Camp', 'Pune', 5000000),
('Wadia College', 'Pune', 7500000),
('MG Road', 'Mumbai', 9000000);

INSERT INTO Account VALUES
(1001, 'Pune_Station', 25000),
(1002, 'Camp', 18000),
(1003, 'MG Road', 12000),
(1004, 'Wadia College', 35000);

INSERT INTO Customer VALUES
('Amit Joshi', 'FC Road', 'Pune'),
('Priya Patil', 'MG Road', 'Mumbai'),
('Rohit Shinde', 'Karve Nagar', 'Pune'),
('Sneha Desai', 'JM Road', 'Pune'),
('Naina Kale', 'Tilak Road', 'Nashik');

INSERT INTO Depositor VALUES
('Amit Joshi', 1001),
('Priya Patil', 1003),
('Rohit Shinde', 1002),
('Sneha Desai', 1004);

INSERT INTO Loan VALUES
(2001, 'Pune_Station', 15000),
(2002, 'Camp', 12000),
(2003, 'Wadia College', 20000);

INSERT INTO Borrower VALUES
('Amit Joshi', 2001),
('Rohit Shinde', 2002),
('Naina Kale', 2003);


1)

CREATE VIEW View1 AS
SELECT DISTINCT C.cust_name
FROM Customer C
JOIN Borrower B ON C.cust_name = B.cust_name
JOIN Loan L ON B.loan_no = L.loan_no
WHERE L.branch_name = 'Pune_Station'
ORDER BY C.cust_name ASC;

-- View Output
SELECT * FROM View1;


2)

CREATE VIEW View2 AS
SELECT branch_name, branch_city
FROM Branch;

-- SELECT to view data
SELECT * FROM View2;

-- INSERT (adds a new branch)
INSERT INTO View2 VALUES ('Deccan', 'Pune');

-- UPDATE (change city)
UPDATE View2 SET branch_city = 'Mumbai' WHERE branch_name = 'Camp';

-- DELETE (remove a branch)
DELETE FROM View2 WHERE branch_name = 'Deccan';


3)

CREATE VIEW View3 AS
SELECT B.cust_name AS borrower_name, D.acc_no
FROM Borrower B
JOIN Depositor D ON B.cust_name = D.cust_name;

-- SELECT to view data
SELECT * FROM View3;

-- INSERT (possible only if underlying tables allow it)
-- Example: inserting a new customer who is both depositor & borrower
INSERT INTO Borrower VALUES ('Sneha Desai', 2003);
INSERT INTO Depositor VALUES ('Sneha Desai', 1004);

-- UPDATE
UPDATE Borrower SET loan_no = 2002 WHERE cust_name = 'Naina Kale';

-- DELETE
DELETE FROM Borrower WHERE cust_name = 'Rohit Shinde';


4)

SELECT C.cust_name, A.acc_no, B.loan_no
FROM Customer C
LEFT JOIN Depositor D ON C.cust_name = D.cust_name
LEFT JOIN Account A ON D.acc_no = A.acc_no
LEFT JOIN Borrower B ON C.cust_name = B.cust_name

UNION

SELECT C.cust_name, A.acc_no, B.loan_no
FROM Customer C
RIGHT JOIN Depositor D ON C.cust_name = D.cust_name
RIGHT JOIN Account A ON D.acc_no = A.acc_no
RIGHT JOIN Borrower B ON C.cust_name = B.cust_name;


5)

-- Simple index on branch_city (for faster search)
CREATE INDEX idx_branch_city ON Branch(branch_city);

-- Unique index on customer name (since itâ€™s unique in this design)
CREATE UNIQUE INDEX idx_customer_name ON Customer(cust_name);

6) 

SHOW INDEX FROM Branch;
SHOW INDEX FROM Customer;
